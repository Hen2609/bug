{
  "version": 3,
  "sources": ["../../marko/src/core-tags/core/__flush_here_and_after__.js"],
  "sourcesContent": ["const BufferedWriter = require(\"../../runtime/html/BufferedWriter\");\n\nmodule.exports = function __flushHereAndAfter__(input, out) {\n  if (out.isSync()) {\n    // We create an async out that we pinky promise is going to be sync in order to postpone execution of the renderBody.\n    out._sync = false;\n    const asyncOut = out.beginAsync({ last: true });\n    out._sync = true;\n    asyncOut.sync();\n    out.onLast(() => {\n      input.renderBody(asyncOut);\n      asyncOut.end();\n    });\n  } else {\n    let flushed = false;\n    const asyncOut = out.beginAsync({ last: true });\n    const nextWriter = out.writer;\n\n    out.on(\"___toString\", writer => {\n      if (writer instanceof BufferedWriter) {\n        if (flushed) {\n          const detachedOut = out.createOut();\n          detachedOut.sync();\n          input.renderBody(detachedOut);\n          writer._content = detachedOut.toString() + writer._content;\n        } else if (writer.next === nextWriter) {\n          asyncOut.sync();\n          input.renderBody(asyncOut);\n          asyncOut.end();\n          flushed = true;\n        }\n      }\n    });\n\n    out.onLast(() => {\n      if (!flushed) {\n        asyncOut.sync();\n        input.renderBody(asyncOut);\n        asyncOut.end();\n        flushed = true;\n      }\n    });\n  }\n};\n"],
  "mappings": ";;;;;;;;;;AAAA;AAAA;AAAA,QAAM,iBAAiB;AAEvB,WAAO,UAAU,SAAS,sBAAsB,OAAO,KAAK;AAC1D,UAAI,IAAI,OAAO,GAAG;AAEhB,YAAI,QAAQ;AACZ,cAAM,WAAW,IAAI,WAAW,EAAE,MAAM,KAAK,CAAC;AAC9C,YAAI,QAAQ;AACZ,iBAAS,KAAK;AACd,YAAI,OAAO,MAAM;AACf,gBAAM,WAAW,QAAQ;AACzB,mBAAS,IAAI;AAAA,QACf,CAAC;AAAA,MACH,OAAO;AACL,YAAI,UAAU;AACd,cAAM,WAAW,IAAI,WAAW,EAAE,MAAM,KAAK,CAAC;AAC9C,cAAM,aAAa,IAAI;AAEvB,YAAI,GAAG,eAAe,YAAU;AAC9B,cAAI,kBAAkB,gBAAgB;AACpC,gBAAI,SAAS;AACX,oBAAM,cAAc,IAAI,UAAU;AAClC,0BAAY,KAAK;AACjB,oBAAM,WAAW,WAAW;AAC5B,qBAAO,WAAW,YAAY,SAAS,IAAI,OAAO;AAAA,YACpD,WAAW,OAAO,SAAS,YAAY;AACrC,uBAAS,KAAK;AACd,oBAAM,WAAW,QAAQ;AACzB,uBAAS,IAAI;AACb,wBAAU;AAAA,YACZ;AAAA,UACF;AAAA,QACF,CAAC;AAED,YAAI,OAAO,MAAM;AACf,cAAI,CAAC,SAAS;AACZ,qBAAS,KAAK;AACd,kBAAM,WAAW,QAAQ;AACzB,qBAAS,IAAI;AACb,sBAAU;AAAA,UACZ;AAAA,QACF,CAAC;AAAA,MACH;AAAA,IACF;AAAA;AAAA;",
  "names": []
}
